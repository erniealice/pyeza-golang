/*
 * ==========================================================================
 * AVATAR COMPONENT STYLES (rem-based)
 * ==========================================================================
 * Profile images with initials fallback, async image loading,
 * preset sizes, custom rem sizing, and status indicators.
 * ==========================================================================
 */

/* ========================================
   BASE AVATAR
   ======================================== */

.avatar {
    --avatar-size: 2.5rem; /* 40px — md default */
    --avatar-font: 0.875rem; /* 14px */
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--avatar-size);
    height: var(--avatar-size);
    border-radius: var(--radius-round);
    background: var(--accent-primary-light);
    color: var(--accent-primary);
    flex-shrink: 0;
    overflow: hidden;
    user-select: none;
}

/* ========================================
   FALLBACK TEXT (Initials)
   ======================================== */

.avatar-fallback {
    font-family: var(--font-body);
    font-size: var(--avatar-font);
    font-weight: 600;
    line-height: 1;
    text-transform: uppercase;
    letter-spacing: 0.02em;
}

/* ========================================
   IMAGE (Async overlay)
   ========================================
   The image sits on top of the fallback.
   While loading, the fallback is visible.
   On error, onerror hides the img, showing fallback.
   ======================================== */

.avatar-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--radius-round);
}

/* ========================================
   SIZE PRESETS
   ======================================== */

/* Extra small — 24px */
.avatar-xs {
    --avatar-size: 1.5rem;
    --avatar-font: 0.5625rem; /* 9px */
}

/* Small — 32px */
.avatar-sm {
    --avatar-size: 2rem;
    --avatar-font: 0.6875rem; /* 11px */
}

/* Medium — 40px (default) */
.avatar-md {
    --avatar-size: 2.5rem;
    --avatar-font: 0.875rem; /* 14px */
}

/* Large — 56px */
.avatar-lg {
    --avatar-size: 3.5rem;
    --avatar-font: 1.125rem; /* 18px */
}

/* Extra large — 80px */
.avatar-xl {
    --avatar-size: 5rem;
    --avatar-font: 1.5rem; /* 24px */
}

/* ========================================
   COLOR VARIANTS (Fallback backgrounds)
   ========================================
   Auto-assigned from Name hash in template,
   or set explicitly via Color param.
   ======================================== */

/* Default (uses accent-primary) — already in base */

.avatar-terracotta {
    background: var(--accent-terracotta-light);
    color: var(--accent-terracotta);
}

.avatar-sage {
    background: var(--accent-sage-light);
    color: var(--accent-sage);
}

.avatar-navy {
    background: var(--accent-navy-light);
    color: var(--accent-navy);
}

.avatar-amber {
    background: var(--accent-amber-light);
    color: var(--accent-amber);
}

.avatar-plum {
    background: rgba(139, 107, 142, 0.15);
    color: var(--accent-plum);
}

/* ========================================
   STATUS DOT
   ======================================== */

.avatar-status {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 0.625rem; /* 10px */
    height: 0.625rem;
    border-radius: var(--radius-round);
    border: var(--border-width-thick) solid var(--bg-card);
    z-index: 1;
}

.avatar-status-online {
    background: var(--status-success);
}

.avatar-status-offline {
    background: var(--text-muted);
}

.avatar-status-busy {
    background: var(--status-error);
}

.avatar-status-away {
    background: var(--status-warning);
}

/* Scale status dot with avatar size */
.avatar-xs .avatar-status {
    width: 0.4375rem; /* 7px */
    height: 0.4375rem;
    border-width: 1px;
}

.avatar-sm .avatar-status {
    width: 0.5rem; /* 8px */
    height: 0.5rem;
    border-width: 1.5px;
}

.avatar-lg .avatar-status {
    width: 0.75rem; /* 12px */
    height: 0.75rem;
}

.avatar-xl .avatar-status {
    width: 1rem; /* 16px */
    height: 1rem;
    border-width: 3px;
}

/* Pulse animation for online status */
.avatar-status-online::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: var(--radius-round);
    background: var(--status-success);
    opacity: 0;
    animation: avatarPulse 2s ease-in-out infinite;
}

@keyframes avatarPulse {
    0%, 100% { opacity: 0; transform: scale(1); }
    50% { opacity: 0.3; transform: scale(1.4); }
}

/* ========================================
   AVATAR GROUP (Stacked)
   ======================================== */

.avatar-group {
    display: inline-flex;
    flex-direction: row-reverse; /* Rightmost on top via DOM order */
}

.avatar-group .avatar {
    border: var(--border-width-thick) solid var(--bg-card);
    margin-left: -0.5rem; /* Overlap */
    transition: transform var(--duration-fast) var(--ease-default);
}

.avatar-group .avatar:last-child {
    margin-left: 0;
}

.avatar-group .avatar:hover {
    transform: translateY(-0.125rem); /* -2px — lift on hover */
    z-index: 1;
}

/* Smaller overlap for small avatars */
.avatar-group .avatar-xs {
    margin-left: -0.375rem;
}

.avatar-group .avatar-sm {
    margin-left: -0.4375rem;
}

/* ========================================
   RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
    /* Slightly reduce large avatars on mobile */
    .avatar-lg {
        --avatar-size: 3rem;
        --avatar-font: 1rem;
    }

    .avatar-xl {
        --avatar-size: 4rem;
        --avatar-font: 1.25rem;
    }
}

/* ========================================
   ACCESSIBILITY
   ======================================== */

@media (prefers-reduced-motion: reduce) {
    .avatar-status-online::after {
        animation: none;
    }

    .avatar-group .avatar {
        transition: none;
    }
}

@media (prefers-contrast: high) {
    .avatar {
        border: var(--border-width-thick) solid currentColor;
    }

    .avatar-status {
        border-color: var(--text-primary);
    }
}
